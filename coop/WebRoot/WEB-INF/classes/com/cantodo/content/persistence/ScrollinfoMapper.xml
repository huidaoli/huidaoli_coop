<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cantodo.content.persistence.ScrollinfoMapper">


	<resultMap type="com.cantodo.content.dto.Scrollinfo"
		id="scrollinfoMap">
		<id property="id" column="id" />
		<result property="imgid" column="imgid" />
		<result property="name" column="name" />
		<result property="createDate" column="createDate" />
		<result property="ctype" column="ctype" />
		<result property="contcode" column="contcode" />
		<result property="newname" column="newname" />
	</resultMap>
	

	<select id="getAllInfo" parameterType="map"
		resultMap="scrollinfoMap">
		SELECT id,imgid,name,createDate,ctype,contcode FROM t_scrollinfo
		<where>
			<if test="cname != null">AND name like #{cname}</if>
			<if test="cctype != null">AND ctype = #{cctype}</if>
		</where>
		order by id desc limit #{offset} , #{rows}
	</select>
	
	<select id="getAllInfoSearch" parameterType="String"
		resultMap="scrollinfoMap">
		SELECT t1.id,t1.name,t1.createDate,t1.ctype,t1.contcode,t2.newname as imgid FROM t_scrollinfo t1 left join t_atta t2
        on t1.contcode = t2.contcode where t1.ctype =#{cctype}
	</select>
	
	
	<select id="getCounts" parameterType="map" resultType="int">
		SELECT count(1) FROM t_resource
		<where>
			<if test="cname != null">AND name like #{cname}</if>
			<if test="cctype != null">AND ctype = #{cctype}</if>
		</where>
	</select>
	
	<select id="getCounts2" resultType="int" parameterType="int">
		SELECT count(1) FROM t_scrollinfo where ctype = #{ctype}
	</select>
	

	<select id="getInfoById" parameterType="map"
		resultType="Scrollinfo">
		SELECT t1.id,t1.name,t1.createDate,t1.ctype,t1.contcode,t2.newname as imgid FROM t_scrollinfo t1 left join t_atta t2
        on t1.contcode = t2.contcode
		where t1.id=#{id} and t1.ctype= #{cctype}
	</select>

	<insert id="insert" parameterType="Scrollinfo">
		INSERT INTO t_scrollinfo (imgid,name,createDate,ctype,contcode)
		VALUES (#{imgid},#{name},#{createDate},#{ctype},#{contcode})
	</insert>
	
	<delete id="delete" parameterType="int">
		delete from t_scrollinfo where id=#{id}
	</delete>
	
	<update id="update" parameterType="Scrollinfo">
		update t_scrollinfo set imgid= #{imgid},name= #{name},createDate= #{createDate} where id=#{id}
	</update>


</mapper>